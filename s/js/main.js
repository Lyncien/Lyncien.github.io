function MsgBox(e,t){t=void 0===t||t;var n=this;this.ele=document.getElementById(e),this.body=this.ele.firstElementChild,this.closeButton=this.body.firstElementChild,this.closeButton.addEventListener("click",function(){n.hide()}),t&&this.ele.addEventListener("click",function(){n.hide()}),this.body.addEventListener("click",function(e){e.target!=n.closeButton&&e.stopPropagation()})}function ProgressBar(e){this.ele=document.getElementById(e),this.ele.style.opacity="0",this.ele.style.width="0"}function __scrollTo(e,t){var n=this,o="auto";if("number"==typeof e)i=e,a=t;else{if("object"!=typeof e)return;var i=e.left,a=e.top,o=e.behavior||"auto"}if("smooth"!=o)return void 0!==i&&(n.scrollLeft=i),void(void 0!==a&&(n.scrollTop=a));var r=n.scrollLeft,c=i-r,s=n.scrollTop,l=a-s,d=null,u=500,m=0;window.requestAnimationFrame(function e(t){m=(t-(d=d||t))/u,void 0!==i&&(n.scrollLeft=m<=.5?c*m*m*2+r:i-c*(1-m)*(1-m)*2),void 0!==a&&(n.scrollTop=m<=.5?l*m*m*2+s:a-l*(1-m)*(1-m)*2),m<1?window.requestAnimationFrame(e):(void 0!==i&&(n.scrollLeft=i),void 0!==a&&(n.scrollTop=a))})}function http_get_text(e,t,n){t=t||function(){},n=n||function(){};var o=new XMLHttpRequest;o.open("get",e,!0),o.onload=function(){200==o.status?t(o.responseText):n()},o.onerror=o.abort=o.ontimeout=n,o.send()}function http_get_text_with_progress(e,t,n,o,i){t=t||function(){},n=n||function(){};var a=new XMLHttpRequest;a.open("get",e,!0),a.__content_percent=0,a.addEventListener("progress",function(e){var t=e.loaded,e=e.total;0!=e?this.__content_percent=Math.ceil(100*t/e):this.__content_percent+=(100-this.__content_percent)/2,i(30+.3*this.__content_percent)},!1),a.addEventListener("readystatechange",function(){1==this.readyState?i(10):2==this.readyState?i(30):3==this.readyState?i(40):4==this.readyState&&(i(70),200==this.status&&t(this.responseText))},!1),a.addEventListener("loadstart",function(){i(20)},!1),a.addEventListener("load",function(){i(80)},!1),a.addEventListener("loadend",function(){i(100),o()},!1),a.onerror=a.abort=a.ontimeout=n,a.send()}function copy(e){if(document.queryCommandSupported&&document.queryCommandSupported("copy")||document.execCommand){var t=document.getElementById("copy-textarea");if(t||((t=document.createElement("textarea")).id="copy-textarea",t.style.position="fixed",t.style.top="1e6px",t.style.opacity="0",t.readOnly=!0,document.body.append(t)),t.value=e,t.select(),t.setSelectionRange(0,e.length),document.execCommand("copy"))return!0}return!1}function isObject(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function debounce(o,n,e){var i,a,r,c,s,l,d=0,u=!1,m=!1,t=!0;if("function"!=typeof o)throw new TypeError(FUNC_ERROR_TEXT);function f(e){var t=i,n=a;return i=a=void 0,d=e,c=o.apply(n,t)}function h(e){var t=e-l;return void 0===l||n<=t||t<0||m&&r<=e-d}function g(){var e,t=Date.now();if(h(t))return v(t);s=setTimeout(g,(t=n-((e=t)-l),m?Math.min(t,r-(e-d)):t))}function v(e){return s=void 0,t&&i?f(e):(i=a=void 0,c)}function p(){var e=Date.now(),t=h(e);if(i=arguments,a=this,l=e,t){if(void 0===s)return d=t=l,s=setTimeout(g,n),u?f(t):c;if(m)return clearTimeout(s),s=setTimeout(g,n),f(l)}return void 0===s&&(s=setTimeout(g,n)),c}return n=parseInt(n)||0,isObject(e)&&(u=!!e.leading,m="maxWait"in e,r=m?Math.max(parseInt(e.maxWait)||0,n):r,t="trailing"in e?!!e.trailing:t),p.cancel=function(){void 0!==s&&clearTimeout(s),i=l=a=s=void(d=0)},p.flush=function(){return void 0===s?c:v(Date.now())},p}function getStyle(e,t){return getComputedStyle(e)[t]}function getStyleInt(e,t){return parseInt(getComputedStyle(e)[t])}function loadJS(e,t){var n=document.getElementsByTagName("head")[0]||document.head||document.documentElement,o=document.createElement("script");o.setAttribute("type","text/javascript"),o.setAttribute("charset","UTF-8"),o.setAttribute("src",e),"function"==typeof t&&(window.attachEvent?o.onreadystatechange=function(){var e=o.readyState;"loaded"!==e&&"complete"!==e||(o.onreadystatechange=null,t())}:o.onload=t),n.appendChild(o)}function removeJS(e){e=(document.getElementsByTagName("head")[0]||document.head||document.documentElement).querySelector('script[src="'+e+'"]');e&&e.remove()}function html_escape(e){return e.replace(/[<>"&]/g,function(e,t,n){switch(e){case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;";case'"':return"&quot;"}})}function initPostCatalogue(n,e,o,t){for(var i,a,r,c,s=i=a=r=c=[],l=e.children,d=0,u=null;d<l.length;d++)"H1"==(u=l[d]).tagName?(u.classList.add("anchor"),s.push({ele:u,children:i=[]})):"H2"==u.tagName?(u.classList.add("anchor"),i.push({ele:u,children:a=[]})):"H3"==u.tagName?(u.classList.add("anchor"),a.push({ele:u,children:r=[]})):"H4"==u.tagName?(u.classList.add("anchor"),r.push({ele:u,children:c=[]})):"H5"==u.tagName&&(u.classList.add("anchor"),c.push({ele:u,children:[]}));function m(e,t){for(var n=e.offsetTop,o=e.offsetParent;null!==o&&o!=t;)n+=o.offsetTop,o=o.offsetParent;return n}t.innerHTML=function t(e){var n="<ol>";return e.forEach(function(e){0==e.children?n+='<li><a href="javascript:;">'+e.ele.innerText+"</a></li>":n+='<li><a href="javascript:;">'+e.ele.innerText+"</a>"+t(e.children)+"</li>"}),n+="</ol>"}(s);function f(){v=g.map(function(e){return m(e,t)})}var h=Array.prototype.slice.call(e.querySelectorAll(".anchor")),g=Array.prototype.slice.call(t.querySelectorAll("a")),v=g.map(function(e){return m(e,t)});window.addEventListener("resize",f),n.onscroll=debounce(function(){for(var e=0,t=n.scrollTop;e<h.length&&h[e].offsetTop-t<1;e++)g[e].parentNode.className="read";for(0<e&&(g[e-1].parentNode.className="current",o.scrollTo({top:v[e-1]-o.offsetHeight/2,behavior:"smooth"}));e<h.length;e++)g[e].parentNode.className=""},100);for(d=0;d<g.length;d++)!function(t){g[t].onclick=function(e){e.preventDefault(),n.scrollTo({top:h[t].offsetTop,behavior:"smooth"})}}(d);return function(){window.removeEventListener("resize",f),t.innerHTML=""}}function initPostMermaid(e){if(!config.mermaid||!config.mermaid.offline){for(var t=e.querySelectorAll(".mermaid"),n=0;n<t.length;n++)mermaid.init({},t[n]);for(var t=e.querySelectorAll(".Mermaid"),o=0;o<t.length;o++)mermaid.init({},t[o])}}function initPostMath(e){config.mathjax&&config.mathjax.offline||MathJax.Hub.Typeset(e)}function initPostCode(e){for(var t=e.querySelectorAll("pre code"),n=0;n<t.length;n++){hljs.highlightBlock(t[n]);var o="<line>"+t[n].innerHTML.trim().replace(/\n/g,"\n</line><line>")+"\n</line>";t[n].parentNode.innerHTML='<code><div class="code-inner">'+o+'</div></code><div class="code-copy-button"><span></span> <i class="fa fa-clipboard"></i></div>'}for(var i=e.querySelectorAll(".code-copy-button"),n=0;n<i.length;n++)i[n].addEventListener("click",function(e){for(var t=this.firstChild,n=this.previousElementSibling.firstElementChild.childNodes,o="",i=0;i<n.length;i++)"LINE"==n[i].nodeName&&(o+=n[i].innerText);copy(o)?t.innerText="复制成功":t.innerText="复制失败",t.style.opacity=1,setTimeout(function(){t.style.opacity=0},700)})}function initPostFootnote(e,t){for(var n=t.querySelectorAll('sup[id^="fn_ref_"]'),o=0;o<n.length;o++){var i=n[o],a=i.lastElementChild.getAttribute("href").slice(1),a=document.getElementById(a);i.lastElementChild.href="javascript:;",a.lastElementChild.href="javascript:;",((i._footnote=a)._footnoteRef=i).onclick=function(){e.scrollTo({top:this._footnote.offsetTop,behavior:"smooth"})},a.onclick=function(){e.scrollTo({top:this._footnoteRef.offsetTop,behavior:"smooth"})}}}function initComment(){var e;config.comment_plugin&&config.comment_plugin.enable&&("changyan"==config.comment_plugin.type?document.getElementById("comment")&&(e="https://changyan.sohu.com/upload/changyan.js",window.changyan=void 0,window.cyan=void 0,removeJS(e),loadJS(e,function(){window.changyan.api.config({appid:"cyw2kkJjE",conf:"prod_2d974c914fc99dce7038d81f8b00102a"})})):"gitalk"==config.comment_plugin.type&&(e=new Gitalk({clientID:"e46f6dec7c07145c652c",clientSecret:"d1a0b627f9b76d21bd3080d1777d0aa0ad55dd83",accessToken:"6a2f4d91a1f188a2089e70c2a7b63628f3e9e664",repo:"gitalk",owner:"gitalk",admin:["booxood","mamboer"],id:"Demo",distractionFreeMode:!0}),document.getElementById("comment")&&e.render("comment")))}function reloadBusuanzi(){var e=document.getElementById("busuanzi-script");e&&e.parentNode.removeChild(e);e=document.createElement("SCRIPT");e.type="text/javascript",e.src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js",e.id="busuanzi-script",document.head.appendChild(e)}MsgBox.prototype.show=function(){this.ele.classList.add("acitve")},MsgBox.prototype.hide=function(){this.ele.classList.contains("acitve")&&this.ele.classList.remove("acitve")},ProgressBar.prototype.set=function(e,t){var n;this.uid&&e!=this.uid||((n=this.ele).style.width=t+"%",0<=t&&(n.classList.add("running"),n.style.opacity="1"),100==t&&(this.t1=setTimeout(function(e){n.classList.remove("running"),n.style.opacity="0",e.t2=setTimeout(function(){n.style.width="0"},1e3)},1e3,this)))},ProgressBar.prototype.reset=function(e){var t=this.ele;clearTimeout(this.t1),clearTimeout(this.t2),t.classList.remove("running"),t.style.opacity="0",t.style.width="0",this.uid=e},Element.prototype.scrollTo&&CSS.supports("scroll-behavior","smooth")||(Element.prototype.scrollTo=__scrollTo),http_get_text(config.root+"search.json",function(e){e=JSON.parse(e);window.search_items=e.map(function(e){return{title:(e.title||"").trim(),content:(e.content||"").trim(),url:e.url}})}),window.addEventListener("DOMContentLoaded",function(){var e=document.getElementById("search-input"),t=document.getElementById("search-result");e.addEventListener("input",function(){var m,f;this.value.trim().length<=0||(m=this.value.trim().toLowerCase().split(/[\s\-]+/),f="",window.search_items.forEach(function(e){if(""!==e.title&&""!==e.content){for(var t,n,o,i=e.title.toLowerCase(),a=e.content.toLowerCase(),r=-1,c=0;c<m.length;c++){if(o=m[c],t=i.indexOf(o),n=a.indexOf(o),t<0&&n<0)return;0==c&&(r=n)}var s=r-20,l=r+80;s<0&&(s=0,l=100),l>e.content.length&&(l=e.content.length);var d=html_escape(e.content.substring(s,l)),u=html_escape(e.title);m.forEach(function(e){e=html_escape(e);var t=new RegExp(e,"gi");u=u.replace(t,'<strong class="keyword">'+e+"</strong>"),d=d.replace(t,'<strong class="keyword">'+e+"</strong>")}),f+='<div class="search-result-item"><a href="javascript:;" onclick="load(\''+e.url+'\');" class="title">'+u+'</a><p class="content">'+d+"...</p></div>"}}),t.innerHTML=f)})});var removePostCatalogue=function(){},actived_file_link="",actived_file_items=[],middle_inner=document.getElementById("middle-inner"),directory=document.getElementById("directory"),catalogue=document.getElementById("catalogue"),header=document.getElementById("header"),nav=document.getElementById("nav"),directory_button=document.getElementById("nav-mobile-directory-button"),catalogue_button=document.getElementById("nav-mobile-catalogue-button"),main_inner=document.getElementById("main-inner"),scroll_dom=middle_inner,article_content_dom=null,loading_progress_bar=new ProgressBar("progress-bar"),search_msgbox=new MsgBox("search-msg-box");function resetHeader(){header.classList.remove("expand"),header.style.height="50px"}function toggleHeader(){header.classList.toggle("expand"),header.classList.contains("expand")?header.style.height=getStyleInt(nav,"height")+75+"px":header.style.height="50px"}function resetDirectory(){directory.classList.remove("show"),document.body.classList.remove("directory-show"),directory_button.classList.remove("show")}function showDirectory(){directory.classList.add("show"),document.body.classList.add("directory-show"),directory_button.classList.add("show")}function toggleDirectory(){directory.classList.toggle("show"),document.body.classList.toggle("directory-show"),directory_button.classList.toggle("show")}function resetCatalogue(){catalogue.classList.remove("show"),document.body.classList.remove("catalogue-show"),catalogue_button.classList.remove("show")}function showCatalogue(){catalogue.classList.add("show"),document.body.classList.add("catalogue-show"),catalogue_button.classList.add("show")}function toggleCatalogue(){catalogue.classList.toggle("show"),document.body.classList.toggle("catalogue-show"),catalogue_button.classList.toggle("show")}function windowResizeHandler(){resetHeader(),showDirectory(),showCatalogue(),window.innerWidth<=992&&resetDirectory(),window.innerWidth<=768&&resetCatalogue()}function changeTheme(){"dark"==document.documentElement.dataset.userColorScheme?(document.documentElement.dataset.userColorScheme="light",document.getElementById("nav-theme-button").firstElementChild.firstElementChild.classList.replace("fa-moon-o","fa-sun-o"),document.getElementById("nav-mobile-theme-button").firstElementChild.classList.replace("fa-moon-o","fa-sun-o")):(document.documentElement.dataset.userColorScheme="dark",document.getElementById("nav-theme-button").firstElementChild.firstElementChild.classList.replace("fa-sun-o","fa-moon-o"),document.getElementById("nav-mobile-theme-button").firstElementChild.classList.replace("fa-sun-o","fa-moon-o"))}function setupEventListener(){document.getElementById("go-to-top").addEventListener("click",function(){scroll_dom.scrollTo({top:0,behavior:"smooth"})}),document.getElementById("go-to-bottom").addEventListener("click",function(){scroll_dom.scrollTo({top:scroll_dom.scrollHeight,behavior:"smooth"})}),document.getElementById("nav-search-button").addEventListener("click",function(){search_msgbox.show()}),document.getElementById("nav-mobile-search-button").addEventListener("click",function(){search_msgbox.show()}),document.getElementById("nav-theme-button").addEventListener("click",function(){changeTheme()}),document.getElementById("nav-mobile-theme-button").addEventListener("click",function(){changeTheme()}),document.getElementById("nav-mobile-toggle-button").addEventListener("click",function(){toggleHeader()}),directory_button.addEventListener("click",function(){toggleDirectory()}),catalogue_button.addEventListener("click",function(){toggleCatalogue()}),main_inner.addEventListener("click",function(){resetHeader(),window.innerWidth<=768&&resetCatalogue(),window.innerWidth<=992&&resetDirectory()});for(var t=nav.getElementsByClassName("nav-item"),e=0;e<3;e++)t[e].addEventListener("click",function(){for(var e=0;e<3;e++)t[e].classList.remove("active");this.classList.add("active"),directory.classList.remove("home"),directory.classList.remove("archive"),directory.classList.remove("tag"),directory.classList.add(this.getAttribute("data-directory-type")),showDirectory()});t[3].addEventListener("click",function(e){e.preventDefault(),load(config.root+"link")}),t[4].addEventListener("click",function(e){e.preventDefault(),load(config.root+"about")}),window.addEventListener("resize",windowResizeHandler),window.addEventListener("popstate",function(e){actived_file_link=this.history.state.link,loadArticle(),activeFileItem()})}function loadArticle(){var t=actived_file_link+Date.now();loading_progress_bar.reset(t),main_inner.innerHTML="",main_inner.classList.add("loading"),removePostCatalogue(),http_get_text_with_progress(actived_file_link,function(e){var t=e.indexOf("<body>")+6,n=e.lastIndexOf("</body>");main_inner.innerHTML=e.slice(t,n),article_content_dom=main_inner.querySelector(".article-content"),initArticle()},function(e,t,n){main_inner.innerHTML='<div style="font-size:2rem;margin:1rem auto;">加载失败!</div>'},function(e,t){main_inner.classList.remove("loading")},function(e){loading_progress_bar.set(t,e)})}function initArticle(){main_inner.querySelectorAll("#post-nav>a").forEach(function(e){e.addEventListener("click",function(e){let t=this.attributes.href.value;"javascript:"!=t.slice(0,11)&&(e.preventDefault(),e.stopPropagation(),load(t))})}),initPostMath(article_content_dom),initPostCode(article_content_dom),initPostFootnote(scroll_dom,article_content_dom),initPostMermaid(article_content_dom),removePostCatalogue=initPostCatalogue(scroll_dom,article_content_dom,catalogue,catalogue.firstElementChild),initComment()}function findFileItemByLink(e){for(var t=directory.querySelectorAll('li.file>a[href="'+e+'"]'),n=[],o=0;o<t.length;o++)n[o]=t[o].parentNode;return n}function activeFileItem(){deactiveFileItem(),actived_file_items=findFileItemByLink(actived_file_link);for(var e=0;e<actived_file_items.length;e++){var t=actived_file_items[e];for(t.classList.add("active"),t=t.parentNode.parentNode;t!=directory.firstElementChild;)t.classList.add("expand"),t=t.parentNode.parentNode}}function deactiveFileItem(){if(0<actived_file_items.length)for(var e=0;e<actived_file_items.length;e++)actived_file_items[e].classList.remove("active");actived_file_items=[]}function setHistoryState(e){(e=e||!1)?history.replaceState({link:actived_file_link},"",actived_file_link):history.pushState({link:actived_file_link},"",actived_file_link)}function load(e,t){actived_file_link=e,loadArticle(),activeFileItem(),setHistoryState(t),reloadBusuanzi()}function initDirectory(){for(var e=directory.querySelectorAll("li"),t=0;t<e.length;t++)"file"==e[t].className?e[t].addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),load(this.firstElementChild.attributes.href.value)}):e[t].addEventListener("click",function(e){e.stopPropagation(),this.classList.toggle("expand")})}window.addEventListener("DOMContentLoaded",function(){setupEventListener(),windowResizeHandler(),initDirectory();let e="";e=""!=location.search?location.search.slice(1):config.root+(config.default_jump_path.replace(/^\//,"")||"about"),load(e,!0)});