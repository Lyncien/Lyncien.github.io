<!DOCTYPE html>
<html lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.8.0">

    <!--[if lt IE 9]>
        <style>body {display: none; background: none !important} </style>
        <meta http-equiv="Refresh" Content="0; url=//outdatedbrowser.com/" />
    <![endif]-->

<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="format-detection" content="telephone=no">
<meta name="author" content="Lyncien">



<meta name="description" content="最短路题目 ddl：12月9日。  实验题目：  给定图的边和边权值（非负数），求给定两顶点间的最短路径。边和边权值（格式为边的兩顶点和权值，勿直接输入邻接矩阵）、两顶点由窗口（文件也可以）输入。输出路径和路径总权值。   基本要求（8分）：  无向图、顶点以自然数命名   扩展：  有向图； 路径除起终顶点外，过另外几个给定顶点； 顶点支持隨意命名； 图形界面； 等等….    说明1.打开Sh">
<meta name="keywords" content="DS">
<meta property="og:type" content="article">
<meta property="og:title" content="数据结构上机题4 最短路径">
<meta property="og:url" content="https://lyncien.github.io/2017/12/09/ds/lab4_ShortestPaths/index.html">
<meta property="og:site_name" content="Lyncien&#39;s homepage">
<meta property="og:description" content="最短路题目 ddl：12月9日。  实验题目：  给定图的边和边权值（非负数），求给定两顶点间的最短路径。边和边权值（格式为边的兩顶点和权值，勿直接输入邻接矩阵）、两顶点由窗口（文件也可以）输入。输出路径和路径总权值。   基本要求（8分）：  无向图、顶点以自然数命名   扩展：  有向图； 路径除起终顶点外，过另外几个给定顶点； 顶点支持隨意命名； 图形界面； 等等….    说明1.打开Sh">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="https://lyncien.github.io/2017/12/09/ds/lab4_ShortestPaths/1.png">
<meta property="og:image" content="https://lyncien.github.io/2017/12/09/ds/lab4_ShortestPaths/1.png">
<meta property="og:updated_time" content="2019-02-19T11:12:08.746Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="数据结构上机题4 最短路径">
<meta name="twitter:description" content="最短路题目 ddl：12月9日。  实验题目：  给定图的边和边权值（非负数），求给定两顶点间的最短路径。边和边权值（格式为边的兩顶点和权值，勿直接输入邻接矩阵）、两顶点由窗口（文件也可以）输入。输出路径和路径总权值。   基本要求（8分）：  无向图、顶点以自然数命名   扩展：  有向图； 路径除起终顶点外，过另外几个给定顶点； 顶点支持隨意命名； 图形界面； 等等….    说明1.打开Sh">
<meta name="twitter:image" content="https://lyncien.github.io/2017/12/09/ds/lab4_ShortestPaths/1.png">

<link rel="apple-touch-icon" href="/apple-touch-icon.png">


    <link rel="alternate" href="/atom.xml" title="Lyncien&#39;s homepage" type="application/atom+xml">



    <link rel="shortcut icon" href="/favicon.png">



    <link href="//cdn.bootcss.com/animate.css/3.5.1/animate.min.css" rel="stylesheet">



    <link href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.css" rel="stylesheet">



    <script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
    <link href="//cdn.bootcss.com/pace/1.0.2/themes/blue/pace-theme-minimal.css" rel="stylesheet">


<link rel="stylesheet" href="/css/style.css">



<link href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">


<title>数据结构上机题4 最短路径 | Lyncien&#39;s homepage</title>

<script src="//cdn.bootcss.com/jquery/2.2.4/jquery.min.js"></script>
<script src="//cdn.bootcss.com/clipboard.js/1.5.10/clipboard.min.js"></script>

<script>
    var yiliaConfig = {
        fancybox: true,
        animate: true,
        isHome: false,
        isPost: true,
        isArchive: false,
        isTag: false,
        isCategory: false,
        fancybox_js: "//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.js",
        scrollreveal: "//cdn.bootcss.com/scrollReveal.js/3.1.4/scrollreveal.min.js",
        search: false
    }
</script>


    <script>
        yiliaConfig.jquery_ui = [true, "//cdn.bootcss.com/jqueryui/1.10.4/jquery-ui.min.js", "//cdn.bootcss.com/jqueryui/1.10.4/css/jquery-ui.min.css"];
    </script>



    <script> yiliaConfig.rootUrl = "\/";</script>






</head></html>
<script src="/js/head-pic.js" ></script> <!-- head-pic-flash by Lyncien -->
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        <a href="/" class="profilepic" id="head-pic">
            <img src="/img/avatar.png" class="animated zoomIn">
        </a>
        <hgroup>
          <h1 class="header-author"><a href="/">Lyncien</a></h1>
        </hgroup>

        

        


        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        <div class="icon-wrap icon-link hide" data-idx="2">
                            <div class="loopback_l"></div>
                            <div class="loopback_r"></div>
                        </div>
                        
                        
                        <div class="icon-wrap icon-me hide" data-idx="3">
                            <div class="user"></div>
                            <div class="shoulder"></div>
                        </div>
                        
                    </div>
                    
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>菜单</li>
                        <li>标签</li>
                        
                        <li>友情链接</li>
                        
                        
                        <li>关于我</li>
                        
                    </ul>
                </div>
            </div>
        

        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a href="/">主页</a></li>
                        
                            <li><a href="/archives/">所有文章</a></li>
                        
                            <li><a href="/tags/">标签云</a></li>
                        
                            <li><a href="/about/">关于我</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa Email" href="mailto:Lyncien@126.com" title="Email"></a>
                            
                                <a class="fa Leetcode" href="https://leetcode-cn.com/lyncien/" title="Leetcode"></a>
                            
                                <a class="fa GitHub" href="https://github.com/Lyncien" title="GitHub"></a>
                            
                                <a class="fa RSS" href="/atom.xml" title="RSS"></a>
                            
                        </ul>
                    </nav>
                </section>
                
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Algorithm/">Algorithm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/C/">C</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/COD/">COD</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Compiler/">Compiler</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DS/">DS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hackergame2018/">Hackergame2018</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MCPS/">MCPS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/OS/">OS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PC/">PC</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Verilog/">Verilog</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/感想/">感想</a></li></ul>
                    </div>
                </section>
                
                
                
                <section class="switch-part switch-part3">
                    <div id="js-friends">
                    
                      <a class="main-nav-link switch-friends-link" href="https://hexo.io">Hexo</a>
                    
                      <a class="main-nav-link switch-friends-link" href="https://pages.github.com/">GitHub</a>
                    
                      <a class="main-nav-link switch-friends-link" href="http://moxfive.xyz/">MOxFIVE</a>
                    
                    </div>
                </section>
                

                
                
                <section class="switch-part switch-part4">
                
                    <div id="js-aboutme">专注于前端</div>
                </section>
                
            </div>
        </div>
    </header>                
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页">Lyncien</a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic" id="head-pic-mobile">
                <img src="/img/avatar.png" class="animated zoomIn">
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="回到主页">Lyncien</a></h1>
            </hgroup>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/">主页</a></li>
                
                    <li><a href="/archives/">所有文章</a></li>
                
                    <li><a href="/tags/">标签云</a></li>
                
                    <li><a href="/about/">关于我</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa Email" target="_blank" href="mailto:Lyncien@126.com" title="Email"></a>
                            
                                <a class="fa Leetcode" target="_blank" href="https://leetcode-cn.com/lyncien/" title="Leetcode"></a>
                            
                                <a class="fa GitHub" target="_blank" href="https://github.com/Lyncien" title="GitHub"></a>
                            
                                <a class="fa RSS" target="_blank" href="/atom.xml" title="RSS"></a>
                            
                        </ul>
            </nav>
        </header>                
    </div>
    <link class="menu-list" tags="标签" friends="友情链接" about="关于我">
</nav>
      <div class="body-wrap"><article id="post-ds/lab4_ShortestPaths" class="article article-type-post" itemscope="" itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/12/09/ds/lab4_ShortestPaths/" class="article-date">
      <time datetime="2017-12-08T16:00:00.000Z" itemprop="datePublished">2017-12-09</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      数据结构上机题4 最短路径
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        

        
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/DS/">DS</a></li></ul>
    </div>

        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h1 id="最短路"><a href="#最短路" class="headerlink" title="最短路"></a>最短路</h1><h2 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h2><ul>
<li><p>ddl：12月9日。</p>
</li>
<li><p>实验题目：</p>
<ul>
<li>给定图的边和边权值（非负数），求给定两顶点间的最短路径。边和边权值（格式为边的兩顶点和权值，勿直接输入邻接矩阵）、两顶点由窗口（文件也可以）输入。输出路径和路径总权值。</li>
</ul>
</li>
<li><p>基本要求（8分）：</p>
<ul>
<li>无向图、顶点以自然数命名</li>
</ul>
</li>
<li><p>扩展：</p>
<ul>
<li>有向图；</li>
<li>路径除起终顶点外，过另外几个给定顶点；</li>
<li>顶点支持隨意命名；</li>
<li>图形界面；</li>
<li>等等….</li>
</ul>
</li>
</ul>
<h2 id="说明"><a href="#说明" class="headerlink" title="说明"></a>说明</h2><p>1.打开ShortestPaths.exe，选择有向图模式或无向图模式</p>
<p>2.点击帮助按钮查看如何操作</p>
<p>3.点击导入文件可导入事先建好的图，.udg为无向图文件，.dg为有向图文件，只能导入运行程序目录下的文件，只输入文件名（不用输入后缀名，会根据当前模式读取对应文件）</p>
<p>4.导入后，左键单击某个顶，呈选中状态（绿色），然后按住SHIFT，再左键单击另一个顶，将求出最短路径，路径高亮加粗显示（黄色）。</p>
<p>5.ShortestPaths文件夹内为工程源代码，在VS2010下创建，ShortestPaths.cpp绘制界面和处理键鼠操作，graph.h为图数据结构声明和基本操作</p>
<h2 id="截图"><a href="#截图" class="headerlink" title="截图"></a>截图</h2><p><img src="//lyncien.github.io/2017/12/09/ds/lab4_ShortestPaths/1.png" alt=""></p>
<p><img src="//lyncien.github.io/2017/12/09/ds/lab4_ShortestPaths/1.png" alt=""></p>
<h1 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h1><p>注：需要easyx图形库</p>
<p>graph.h</p>
<pre><code class="c">#include &lt;string.h&gt;
#define INF 99999999
#define MAX_VERTEX_NUM 100
#define MAX_NAME 10
#define TRUE 1
#define FALSE 0
#define OK 1
#define ERROR 0
#define Status int
typedef enum {DG,DN,UDG,UDN}GraphType;
typedef struct ArcCell{
    int w;//边的权值,0为不连通
}GArc,ArcArray[MAX_VERTEX_NUM][MAX_VERTEX_NUM];
typedef struct Vertex{
    TCHAR name[MAX_NAME];//顶的名称
    int x,y;//用于绘制该顶时的位置
    int l;//dijkstra算法需要
    int state;//=0正常，=1选中
}GVex,VexArray[MAX_VERTEX_NUM];
typedef struct Graph{
    ArcArray arcs;
    VexArray vexs;
    int arcnum,vexnum;
    GraphType type;
}MGraph;
typedef struct DijkstraResult{
    int vexbegin;//表示这个结果是从该顶到其他顶的最短距离
    int prev[MAX_VERTEX_NUM];//最短路径上每个顶的前一个顶
    int dist[MAX_VERTEX_NUM];//每个顶到vexbegin的最短距离
}DijRes;
Status CreateGraph(MGraph* g){
    g-&gt;arcnum=0;
    g-&gt;vexnum=0;
    memset(g-&gt;vexs,0,sizeof(GVex)*MAX_VERTEX_NUM);
    memset(g-&gt;arcs,0,sizeof(GArc)*MAX_VERTEX_NUM*MAX_VERTEX_NUM);
    return OK;
}
Status DestoryGraph(MGraph *g){
    g-&gt;arcnum=0;
    g-&gt;vexnum=0;
    memset(g-&gt;vexs,0,sizeof(GVex)*MAX_VERTEX_NUM);
    memset(g-&gt;arcs,0,sizeof(GArc)*MAX_VERTEX_NUM*MAX_VERTEX_NUM);
    return OK;
}
int LocateVex(MGraph g,TCHAR vexname[]){//获取顶在图中的位置，即在顶数组中的下标,未找到返回-1 
    int i;
    for(i=0;i&lt;g.vexnum;i++){
        if(!_tcscmp(g.vexs[i].name,vexname)) return i;
    }
    return -1;
}
Status InsertVex(MGraph *g,TCHAR vexname[],int x,int y){//添加一个顶，不允许为空，不允许重名 
    _tcscpy_s(g-&gt;vexs[g-&gt;vexnum].name,vexname);
    g-&gt;vexs[g-&gt;vexnum].x=x;
    g-&gt;vexs[g-&gt;vexnum].y=y;
    g-&gt;vexs[g-&gt;vexnum].l=0;
    g-&gt;vexnum++;
    return OK; 
}
Status DeleteVex(MGraph *g,TCHAR vexname[]){
    int i=LocateVex(*g,vexname),j;
    if(i==-1) return ERROR;
    _tcscpy_s(g-&gt;vexs[i].name,g-&gt;vexs[g-&gt;vexnum-1].name);//最后一个顶覆盖要删除的顶 
    _tcscpy_s(g-&gt;vexs[g-&gt;vexnum-1].name,_T(&quot;&quot;));
    for(j=0;j&lt;MAX_VERTEX_NUM;j++){
        g-&gt;arcs[i][j].w=g-&gt;arcs[g-&gt;vexnum-1][j].w;
        g-&gt;arcs[g-&gt;vexnum-1][j].w=0;
    }
    return OK; 
}

DijRes Dijkstra(MGraph g,int v){//求其他各顶到顶v的最短路径
    DijRes r={};
    int flag[MAX_VERTEX_NUM]={0};//标志是否已找到最短路径
    int i,j,mindist,minu;
    for(i=0;i&lt;g.vexnum;i++){//初始化每个顶到v的距离
        if(g.arcs[v][i].w){//连通则初始距离为边权
            r.dist[i]=g.arcs[v][i].w;
            r.prev[i]=v;
        }
        else{//不连通为无穷
            r.dist[i]=INF;
            r.prev[i]=-1;
        }
    }
    r.dist[v]=0;//v到v为0
    flag[v]=1;//v标志为已找到
    for(i=1;i&lt;g.vexnum;i++){//遍历vexnum-1次,每次找出一个顶点的最短路径
        mindist=INF+1;
        minu=-1;
        for (j=0;j&lt;g.vexnum;j++){//求出未标记的顶中到v最短的
            if(flag[j]==0 &amp;&amp; r.dist[j]&lt;mindist){
                mindist=r.dist[j];
                minu=j;
            }
        }
        flag[minu]=1;
        for (j=0;j&lt;g.vexnum;j++){//根据新找到的顶u更新其他各顶最短距离
            int sum=mindist+(g.arcs[minu][j].w==0?INF:g.arcs[minu][j].w); // 边权为0不连通，以无穷计算
            if (flag[j]==0 &amp;&amp; (sum&lt;r.dist[j])){
                r.dist[j]=sum;
                r.prev[j]=minu;
            }
        }

    }

    return r;
}
</code></pre>
<p>ShortestPaths.cpp</p>
<pre><code class="c">    // MinRoad.cpp : 定义控制台应用程序的入口点。
    #define SPACE 20 //按钮间隔大小
    #define HEIGHT 480
    #define WIDTH 800
    #define BUTTONHEIGHT 40 //按钮大小
    #define BUTTONWIDTH 150 //按钮大小
    #define CONTROLWIDTH BUTTONWIDTH+2*SPACE //控制区大小
    #define VEXRADIUS 20 //顶半径
    #define ARROWLEN 10 //箭头斜边的长
    #define PI 3.1415926
    #define HPI 1.5707963

    #include &lt;graphics.h&gt;//easyx图形库头文件
    #include &lt;windows.h&gt;
    #include &lt;stdio.h&gt;
    #include &lt;math.h&gt;
    #include &quot;graph.h&quot;//图
    TCHAR runpath[256];//运行路径
    int MODE=0;//0为无向图，1为有向图
    int vsel=-1;//当前选中顶
    int vmov=-1;//当前移动顶
    MGraph g;//定义一个图
    void DrawButton(int left,int top,LPCTSTR text){

        setbkmode(TRANSPARENT);//设置字体背景透明
        setfillcolor(RGB(136,247,104));//设置填充颜色
        setlinestyle(PS_SOLID,4);//设置线型线宽
        setlinecolor(RGB(249,102,102));//设置线颜色
        settextstyle(25, 0, _T(&quot;宋体&quot;),0,0,FW_BOLD,0,0,0);//设置字体，大小，粗细
        settextcolor(RGB(0,0,255));//设置字体颜色

        RECT r;
        r.left=left; r.top=top; r.right=left+BUTTONWIDTH; r.bottom=top+BUTTONHEIGHT;
        fillroundrect(left,top,left+BUTTONWIDTH,top+BUTTONHEIGHT,5,5);//带边框填充
        drawtext(text,&amp;r,DT_CENTER|DT_VCENTER|DT_SINGLELINE);//输出字
    }
    void InitUI(){
        initgraph(WIDTH, HEIGHT);   // 创建绘图窗口
        int t=SPACE;
        DrawButton(SPACE,t,(LPCTSTR)L&quot;帮  助&quot;);
        t+=SPACE+BUTTONHEIGHT;
        DrawButton(SPACE,t,(LPCTSTR)L&quot;导出文件&quot;);
        t+=SPACE+BUTTONHEIGHT;
        DrawButton(SPACE,t,(LPCTSTR)L&quot;导入文件&quot;);
        t+=SPACE+BUTTONHEIGHT;
        DrawButton(SPACE,t,(LPCTSTR)L&quot;关  于&quot;);
        line(CONTROLWIDTH,0,CONTROLWIDTH,HEIGHT);
        HRGN rgn = CreateRectRgn(CONTROLWIDTH,0,WIDTH,HEIGHT);
        setcliprgn(rgn);//之后的绘图区域只在该矩形内有效
        DeleteObject(rgn);    

    }
    void DrawVex(int i){
        setbkmode(TRANSPARENT);//设置字体背景透明
        setfillcolor(RGB(255,188,121));//设置填充颜色
        setlinestyle(PS_SOLID,4);//设置线型线宽

        if(g.vexs[i].state==0)
            setlinecolor(RGB(129,29,228));//设置线颜色
        else
            setlinecolor(RGB(92,185,0));//设置线颜色(选中状态)
        settextstyle(30, 0, _T(&quot;Arial&quot;),0,0,FW_BOLD+100,0,0,0);//设置字体，大小，粗细
        settextcolor(RGB(255,0,0));//设置字体颜色

        RECT r;
        r.left=g.vexs[i].x-VEXRADIUS; r.top=g.vexs[i].y-VEXRADIUS; 
        r.right=g.vexs[i].x+VEXRADIUS; r.bottom=g.vexs[i].y+VEXRADIUS;
        fillcircle(g.vexs[i].x,g.vexs[i].y,VEXRADIUS);
        drawtext((LPCTSTR)(g.vexs[i].name),&amp;r,DT_CENTER|DT_VCENTER|DT_SINGLELINE);
    }
    double GetAngle(int x1,int y1,int x2,int y2){//从(x1,y1)到(x2,y2)的向量的方位角，以x轴为0度，顺时针，弧度值
        double a=atan(((double)(y2-y1))/(x2-x1));//得到-pi/2~pi/2的弧度值
        if(x2&gt;x1) return a;
        else if(x2==x1) return (y2&gt;=y1)?HPI:-HPI;//pi/2和-pi/2,两点重合这里会返回pi/2
        else return (y2&gt;=y1)?a+PI:a-PI;
    }
    void DrawArc(int i,int j,int mode,int inroad){//画边;mode=0,无向;mode=1,有向,i到j;inroad=1则换一种颜色画边
        if(!inroad){
            setlinestyle(PS_SOLID,3);//设置线型线宽
            setlinecolor(RGB(0,196,166));//设置线颜色
        }
        else{
            setlinestyle(PS_SOLID,4);//设置线型线宽
            setlinecolor(RGB(255,250,28));//设置线颜色
        }
        settextstyle(23, 0, _T(&quot;Arial&quot;),0,0,FW_BOLD,0,0,0);//设置字体，大小，粗细
        TCHAR tw[10]={};

        _stprintf_s(tw,_T(&quot;%d&quot;),g.arcs[i][j].w);//即使对于无向图也通用，因为arcs[i][j]和arcs[j][i]一样

        if(!mode){//无向图，直接连线
            line(g.vexs[i].x,g.vexs[i].y,g.vexs[j].x,g.vexs[j].y);
            outtextxy((g.vexs[i].x+g.vexs[j].x)/2,(g.vexs[i].y+g.vexs[j].y)/2,tw);
        }
        else{//有向图，画边时两个方向的线需要错开，不重叠，并且带箭头
            double a=GetAngle(g.vexs[i].x,g.vexs[i].y,g.vexs[j].x,g.vexs[j].y);//从顶i到j的向量的方位角
            double da=30.0/180.0*PI;//30度角对应的弧度,
            int x1=g.vexs[i].x+cos(a-da)*VEXRADIUS,y1=g.vexs[i].y+sin(a-da)*VEXRADIUS;
            int x2=g.vexs[j].x+cos(a+da-PI)*VEXRADIUS,y2=g.vexs[j].y+sin(a+da-PI)*VEXRADIUS;
            line(x1,y1,x2,y2);//画i到j的边的直线,下面画箭头

            double len1_2=sqrt(pow((long double)(g.vexs[i].x-g.vexs[j].x),2)+pow((long double)(g.vexs[i].y-g.vexs[j].y),2))/2;//该边1/2长
            int arrx=x1+len1_2*cos(a),arry=y1+len1_2*sin(a);//箭头端点所在坐标
            double db=2.617994;//150度角对应的弧度
            line(arrx,arry,arrx+cos(a-db)*ARROWLEN,arry+sin(a-db)*ARROWLEN);//箭头一侧边
            line(arrx,arry,arrx+cos(a+db)*ARROWLEN,arry+sin(a+db)*ARROWLEN);//箭头一侧边
        outtextxy((x1+x2)/2,(y1+y2)/2,tw);
    }
}
void DrawMGraph(){
    clearcliprgn();//清空绘图区
    int i,j;

    for(i=0;i&lt;g.vexnum;i++){//先画边，再画顶不然边会部分叠在顶上
        for(j=0;j&lt;g.vexnum;j++){
            if(g.arcs[i][j].w) DrawArc(i,j,MODE,0);
        }
    }
    for(i=0;i&lt;g.vexnum;i++){
        DrawVex(i);
    }
}

void OnButtonClick(int i){
    FILE* fp;
    TCHAR filename[32]=_T(&quot;test&quot;);
    TCHAR filepath[256];
    switch(i){
        case 1:    MessageBox(GetHWnd(),_T(\
&quot;1.点击空白处添加新顶.\n2.在某顶上按住右键可移动该顶.\n3.左键单击某个顶可以选中.\n4.选中某顶后,ctrl+左键单击另一顶可添加边.\n5.选中某顶后,shift+左键单击另一顶可求最短路径.&quot;\
),_T(&quot;Help&quot;),MB_OK|MB_ICONINFORMATION);
                break;

        case 2:    if(InputBox(filename,32,_T(&quot;文件将保存在当前运行目录下，无向图后缀名为.udg，有向图后缀名为.dg\n请输入文件名(不带后缀名):&quot;),_T(&quot;保存文件&quot;),(LPCTSTR)filename,0,0,0)){
                    _stprintf_s(filepath,_T(&quot;%s%s%s&quot;),runpath,filename,MODE?_T(&quot;.dg&quot;):_T(&quot;.udg&quot;));//生成保存路径

                    if(!_tfopen_s(&amp;fp,filepath,_T(&quot;wb+&quot;))){
                        fwrite(&amp;g,sizeof(g),1,fp);
                        fclose(fp);
                        MessageBox(GetHWnd(),_T(&quot;导出成功！&quot;),_T(&quot;提示&quot;),MB_OK|MB_ICONINFORMATION);
                    }
                    else{
                        MessageBox(GetHWnd(),_T(&quot;文件不存在！！&quot;),_T(&quot;错误&quot;),MB_OK|MB_ICONWARNING);
                    }
                }
                break;
        case 3:    if(InputBox(filename,32,_T(&quot;将打开当前运行目录下的文件，无向图后缀名为.udg，有向图后缀名为.dg\n请输入文件名(不带后缀名):&quot;),_T(&quot;打开文件&quot;),(LPCTSTR)filename,0,0,0)){
                    _stprintf_s(filepath,_T(&quot;%s%s%s&quot;),runpath,filename,MODE?_T(&quot;.dg&quot;):_T(&quot;.udg&quot;));//生成保存路径
                    //MessageBox(GetHWnd(),filepath,_T(&quot;aaa&quot;),MB_OK|MB_ICONINFORMATION);
                    if(!_tfopen_s(&amp;fp,filepath,_T(&quot;rb+&quot;))){
                        fread(&amp;g,sizeof(g),1,fp);
                        fclose(fp);
                        DrawMGraph();
                    }
                    else{
                        MessageBox(GetHWnd(),_T(&quot;文件不存在！！&quot;),_T(&quot;错误&quot;),MB_OK|MB_ICONWARNING);
                    }
                }
                break;
        case 4:    MessageBox(GetHWnd(),_T(&quot;ShortestPaths V1.0\nCode by LinXiang(PB16020923)&quot;),_T(&quot;About&quot;),MB_OK|MB_ICONINFORMATION);
                break;
    }
}
int IsInRange(int a,int up,int down){
    return a&lt;=up &amp;&amp; a&gt;=down;
}
int GetPosInVex(int x,int y){//获取当前坐标下的顶下标，没有返回-1
    int i,xu=x+VEXRADIUS,xd=x-VEXRADIUS,yu=y+VEXRADIUS,yd=y-VEXRADIUS;
    //反过来判断某个顶在不在x,y范围内，这样节省计算，不用算每个顶边界
    for(i=0;i&lt;g.vexnum;i++){
        if(IsInRange(g.vexs[i].x,xu,xd) &amp;&amp; IsInRange(g.vexs[i].y,yu,yd)) return i;
    }
    return -1;
}
void SetVexSelected(int i){
    g.vexs[i].state=1;
    DrawVex(i);//更新为选中状态
    vsel=i;//记下当前选中顶
}
void SetVexNoSelected(){
    g.vexs[vsel].state=0;
    DrawVex(vsel);//更新为正常选中状态
    vsel=-1;//
}
void GetRunPath(TCHAR *text,TCHAR *path){//获取当前运行路径
    int pos;//最后一个\的位置 
    int i=0;
    while(*(text+i)){
        if(*(text+i)==&#39;\\&#39;) pos=i;
        i++;
    }
    _tcscpy_s(path,256,text);
    path[pos+1]=0;
}
int _tmain(int argc,TCHAR *argv[])
{
    GetRunPath(argv[0],runpath);

    if(IDYES==MessageBox(GetHWnd(),_T(&quot;选择‘是’为进入 有向图 模式，\n选择‘否’为进入 无向图 模式。&quot;),_T(&quot;选择模式&quot;),MB_YESNO|MB_ICONQUESTION))
        MODE=1;
    else MODE=0;
    InitUI();
    CreateGraph(&amp;g);
    while(true){
        MOUSEMSG m = GetMouseMsg();// 获取一条鼠标消息
        switch(m.uMsg){
            int vi;
            case WM_MOUSEMOVE://移动
                if(vmov!=-1){
                    g.vexs[vmov].x=m.x;
                    g.vexs[vmov].y=m.y;
                    DrawMGraph();//重绘全部
                }
                break;
            case WM_RBUTTONDOWN://右键按下，开始移动 
                vi=GetPosInVex(m.x,m.y);
                if(vi!=-1)
                    vmov=vi;
                break;
            case WM_RBUTTONUP://右键弹起，结束移动 
                if(vmov!=-1)
                    vmov=-1;
                break;
            case WM_LBUTTONDOWN://按下左键
                if(m.mkCtrl){//同时按下CTRL
                    vi=GetPosInVex(m.x,m.y);
                    if(vi!=-1 &amp;&amp; vsel!=-1 &amp;&amp; vi!=vsel){//按下ctrl选择了一顶，并且之前已经选中一顶，而且两顶不同，则添新边
                        TCHAR tn[10]=_T(&quot;1&quot;);
                        if(InputBox(tn,128,_T(&quot;Input a arc weight&quot;),_T(&quot;Add a arc&quot;),(LPCTSTR)tn,0,0,0)){//输入了权

                            if(!MODE){//无向图
                                g.arcs[vi][vsel].w=g.arcs[vsel][vi].w=_ttoi(tn);
                                DrawArc(vsel,vi,MODE,0);
                            }
                            else{//有向图
                                g.arcs[vsel][vi].w=_ttoi(tn);
                                DrawArc(vsel,vi,MODE,0);
                            }

                        }
                    }
                }
                else if(m.mkShift){//同时按下SHIFT
                    vi=GetPosInVex(m.x,m.y);
                    if(vi!=-1 &amp;&amp; vsel!=-1 &amp;&amp; vi!=vsel){//按下ctrl选择了一顶，并且之前已经选中一顶，而且两顶不同，则求最短路径
                        DrawMGraph();//重绘全部,避免图中有画过其他路径
                        DijRes r=Dijkstra(g,vsel);//求出vel到各顶最短路径
                        int tmp=vi;//倒推路径，先画边
                        while(r.prev[tmp]!=-1){
                            DrawArc(r.prev[tmp],tmp,MODE,1);
                            tmp=r.prev[tmp];
                        }
                        tmp=vi;//倒推路径，再画顶
                        while(tmp!=-1){
                            DrawVex(tmp);
                            tmp=r.prev[tmp];
                        }
                    }
                }
                else{//仅仅按下左键
                    if(m.x&lt;CONTROLWIDTH){//控制区
                        if(m.y%(SPACE+BUTTONHEIGHT)&gt;SPACE)
                            OnButtonClick(m.y/(SPACE+BUTTONHEIGHT)+1);
                    }
                    else{//绘图区
                        int vi=GetPosInVex(m.x,m.y);
                        if(vi!=-1){//按下了某个顶
                            if(vsel!=-1) //如果有选中的，先取消选中状态
                                SetVexNoSelected();
                            SetVexSelected(vi);
                        }
                        else{//按下了空白区域
                            if(vsel!=-1){//如果有选中的，取消选中状态
                            SetVexNoSelected();
                            break;
                        }

                        //以下添加新顶
                                //TCHAR根据是否有UNICODE宏分别对应char和wchar_t
                                //tn相当于TCHAR* 也就是LPTSTR
                        TCHAR tn[MAX_NAME]=_T(&quot;0&quot;);
                        tn[0]+=g.vexnum;
                        if(InputBox(tn,128,_T(&quot;Input a name:&quot;),_T(&quot;Add a vex&quot;),(LPCTSTR)tn,0,0,0)){
                                //_T将字符串常量转为unicode版本，(LPCTSTR)把字符串变量转为常量
                            InsertVex(&amp;g,tn,m.x,m.y);
                            DrawVex(g.vexnum-1);
                        }
                    }
                }
            }
            break;
        }
    }
    closegraph();// 关闭绘图窗口
    return 0;
}
</code></pre>

      
    </div>
    
  </div>
  
    
    <div class="copyright">
        <p><span>本文标题:</span><a href="/2017/12/09/ds/lab4_ShortestPaths/">数据结构上机题4 最短路径</a></p>
        <p><span>文章作者:</span><a href="/" title="回到主页">Lyncien</a></p>
        <p><span>发布时间:</span>2017-12-09, 00:00:00</p>
        <p><span>最后更新:</span>2019-02-19, 19:12:08</p>
        <p>
            <span>原始链接:</span><a class="post-url" href="/2017/12/09/ds/lab4_ShortestPaths/" title="数据结构上机题4 最短路径">https://lyncien.github.io/2017/12/09/ds/lab4_ShortestPaths/</a>
            <span class="copy-path" data-clipboard-text="原文: https://lyncien.github.io/2017/12/09/ds/lab4_ShortestPaths/　　作者: Lyncien" title="点击复制文章链接"><i class="fa fa-clipboard"></i></span>
            <script> var clipboard = new Clipboard('.copy-path'); </script>
        </p>
        <p>
            <span>许可协议:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" title="CC BY-NC-SA 4.0 International" target="_blank">"署名-非商用-相同方式共享 4.0"</a> 转载请保留原文链接及作者。
        </p>
    </div>



    <nav id="article-nav">
        
            <div id="article-nav-newer" class="article-nav-title">
                <a href="/2018/03/11/os/OS_Summary/OS Summary/">
                    操作系统阅读报告：操作系统概述
                </a>
            </div>
        
        
            <div id="article-nav-older" class="article-nav-title">
                <a href="/2017/11/11/ds/lab3_Haffman/">
                    数据结构上机题3 哈夫曼压缩
                </a>
            </div>
        
    </nav>

  
</article>

    <div id="toc" class="toc-article">
        <strong class="toc-title">文章目录</strong>
        
            <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#最短路"><span class="toc-text">最短路</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#题目"><span class="toc-text">题目</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#说明"><span class="toc-text">说明</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#截图"><span class="toc-text">截图</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#代码"><span class="toc-text">代码</span></a></li></ol>
        
    </div>
    <style>
        .left-col .switch-btn,
        .left-col .switch-area {
            display: none;
        }
        .toc-level-6 i,
        .toc-level-6 ol {
            display: none !important;
        }
    </style>

    <input type="button" id="tocButton" value="隐藏目录" title="点击按钮隐藏或者显示文章目录">

    <script>
        yiliaConfig.toc = ["隐藏目录", "显示目录", !!"false"];
    </script>



    
<div class="share">
    
        <div class="bdsharebuttonbox">
            <a href="#" class="fa fa-twitter bds_twi" data-cmd="twi" title="分享到推特"></a>
            <a href="#" class="fa fa-weibo bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a>
            <a href="#" class="fa fa-qq bds_sqq" data-cmd="sqq" title="分享给 QQ 好友"></a>
            <a href="#" class="fa fa-files-o bds_copy" data-cmd="copy" title="复制网址"></a>
            <a href="#" class="fa fa fa-envelope-o bds_mail" data-cmd="mail" title="通过邮件分享"></a>
            <a href="#" class="fa fa-weixin bds_weixin" data-cmd="weixin" title="生成文章二维码"></a>
            <a href="#" class="fa fa-share-alt bds_more" data-cmd="more"></a>
        </div>
        <script>
            window._bd_share_config={
                "common":{"bdSnsKey":{},"bdText":"数据结构上机题4 最短路径　| Lyncien's homepage　","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"0","bdSize":"24"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];
        </script>
    

    
</div>







    




    <div class="scroll" id="post-nav-button">
        
            <a href="/2018/03/11/os/OS_Summary/OS Summary/" title="上一篇: 操作系统阅读报告：操作系统概述">
                <i class="fa fa-angle-left"></i>
            </a>
        

        <a title="文章列表"><i class="fa fa-bars"></i><i class="fa fa-times"></i></a>

        
            <a href="/2017/11/11/ds/lab3_Haffman/" title="下一篇: 数据结构上机题3 哈夫曼压缩">
                <i class="fa fa-angle-right"></i>
            </a>
        
    </div>

    <ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2019/02/25/article/pc_first_problem/">并行计算初探</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/01/17/cp/lab_final/">编译原理课程实验汇报</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/12/10/article/tea_and_health/">茶与健康</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/12/09/alg/lab5/">算法基础上机实验五 图搜索BFS算法及存储优化</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/12/05/mcps/lab_res/">汇编上机资源</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/12/03/mcps/lab4/">汇编上机题4</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/12/02/alg/lab4/">算法基础上机实验四 最佳调度问题</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/11/26/mcps/lab3/">汇编上机题3</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/11/25/alg/lab3/">算法基础上机实验三 最长公共子序列问题</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/11/19/mcps/lab2/">汇编上机题2</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/11/18/alg/lab2/">算法基础上机实验二 红黑树维护算法及其区间树应用</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/11/12/mcps/lab1/">汇编上机题1</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/11/11/alg/lab1/">算法基础上机实验一 求平面上n个顶点的最近点对问题</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/10/27/article/learning_and_forgetting/">学习与遗忘</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/10/15/article/USTC_Hackergame2018_18/">USTC Hackergame2018 之 “加密解密算法”</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/10/12/article/USTC_Hackergame2018_8/">USTCHackergame2018之"我是谁"</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/06/14/cod/lab7_Pipeline-CPU/">计算机组成原理上机实验7 流水线CPU</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/06/13/article/verilog_signed_and_unsigned/">Verilog中的有符号数与无符号数</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/05/23/os/File_System/File System/">操作系统阅读报告：大容量存储器与文件系统</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/05/10/cod/lab6_Multi-CycleCPU/">计算机组成原理上机实验6 多周期CPU</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/05/04/cod/lab5_SingleCycleCPU/">计算机组成原理上机实验5 单周期CPU</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/04/25/os/Process_Communication&Synchronization&Scheduling/Process Communication&Synchronization&Scheduling/">操作系统阅读报告：进程通信与同步、进程调度</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/04/19/cod/lab4_FiniteStateMachine/">计算机组成原理上机实验4 有限状态机</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/03/31/os/Process_Concepts&Operations,Thread/Process Concepts&Operations,Thread/">操作系统阅读报告：进程与线程</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/03/18/os/System_Call/System Call/">操作系统阅读报告：系统调用</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/03/11/os/OS_Summary/OS Summary/">操作系统阅读报告：操作系统概述</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/12/09/ds/lab4_ShortestPaths/">数据结构上机题4 最短路径</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/11/11/ds/lab3_Haffman/">数据结构上机题3 哈夫曼压缩</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/10/29/ds/lab2_Bank/">数据结构上机题2 模拟银行业务办理</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/10/23/ds/lab1_Polynome/">数据结构上机题1 一元稀疏多项式计算</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/01/article/A_Expression_Evaluation/">A Expression Evaluation</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/14/clp/lab10b/">程序设计II上机实验10B："完美阴阳矩阵"</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/13/clp/lab10a/">程序设计II上机实验10A：杀蚂蚁</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/12/clp/lab9b/">程序设计II上机实验9B：八数码问题</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/11/clp/lab9a/">程序设计II上机实验9A：算24</a></li></ul>




    <script>
        
    </script>
</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                <i class="fa fa-copyright"></i> 
                2016-2019 Lyncien
            </div>
            <div class="footer-right">
                <a href="http://hexo.io/" target="_blank" title="快速、简洁且高效的博客框架">Hexo</a>  Theme <a href="https://github.com/MOxFIVE/hexo-theme-yelee" target="_blank" title="简而不减 Hexo 双栏博客主题  v3.5">Yelee</a> by MOxFIVE <i class="fa fa-heart animated infinite pulse"></i>
            </div>
        </div>
        
            <div class="visit">
                
                    <span id="busuanzi_container_site_pv" style="display:none">
                        <span id="site-visit" title="本站到访数"><i class="fa fa-user" aria-hidden="true"></i><span id="busuanzi_value_site_uv"></span>
                        </span>
                    </span>
                
                
                    <span>| </span>
                
                
                    <span id="busuanzi_container_page_pv" style="display:none">
                        <span id="page-visit" title="本页阅读量"><i class="fa fa-eye animated infinite pulse" aria-hidden="true"></i><span id="busuanzi_value_page_pv"></span>
                        </span>
                    </span>
                
            </div>
        
    </div>
</footer>
    </div>
    
<script data-main="/js/main.js" src="//cdn.bootcss.com/require.js/2.2.0/require.min.js"></script>





    <script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script src="//cdn.bootcss.com/mathjax/2.6.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<div class="scroll" id="scroll">
    <a href="#" title="返回顶部"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments" onclick="load$hide();" title="查看评论"><i class="fa fa-comments-o"></i></a>
    <a href="#footer" title="转到底部"><i class="fa fa-arrow-down"></i></a>
</div>
<script>
    // Open in New Window
    
        var oOpenInNew = {
            
            
            
            
            
            
             archives: ".archive-article-title", 
             miniArchives: "a.post-list-link", 
            
             friends: "#js-friends a", 
             socail: ".social a" 
        }
        for (var x in oOpenInNew) {
            $(oOpenInNew[x]).attr("target", "_blank");
        }
    
</script>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
  </div>
</body>
</html>